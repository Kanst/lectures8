
# Сети и телекоммуникации

Еремин Олег Юрьевич

Литература: Таненбаум Э. Компьютерные сети


# Этапы проектирования компьюьтерной сети

1. Описание предметной области
2. Анализ административного деления предприятия
3. Анализ территориального распределения структур предприятия
4. Построение физической инфраструктуры сети предприятия
5. Построение логической инфраструктуры сети предприятия
6. Анализ информационных потоков
7. Подбор оборудования
8. Расчет стоимости создания или модернизации сети
9. Определение регламентов работы с сетью
10. Настройка сетевых служб


# Основные сведения об инфраструктуре сети

**Инфраструктура сети**: это набор физических и логических компонентов, которые обеспечивают связь, безопасность маршрутизацию, управление, доступ и другие обязательные свойства сети.

1. Простые сети
2. Наследствие проекта
3. Внешние обстоятельства (например, подключение к интернету)
4. Физическая инфраструктура сети
  - Топология -- физическое строение сети со всем ее оборудованием: кабелями, маршрутизаторами, мостами, концентраторами, хабами, коммутаторами, серверами и узлами

[СХЕМА СЕТИ]

- H - hub
- SW - switch
- S - server
- WS - work station
- FW - firewall
- R - router
- MD - mobile device
- PSTN - public switched telephone network


## Логическая инфраструктура сети

Логическая инфраструктура сети состоит из всего множества программных элементов, служащих для связи, управления и безопасности сети, и обеспечивающих связь между компьютерами с использованием коммуникационных каналов, определенных в физической топологии.

- DNS
- TCP/IP
- Client Service for NetWare
- QoS (Quality of Service)
  - Quality Management
- VPN
- PKI


# Модель OSI

В основе иерархии лежат 3 концепции:

1. Службы или сервисы. Сервис определяет что делает уровень и каким способом сущности, расположенные выше получают данные
2. Интерфейсы. Определяют способ доступа к расположенному выше уровню, описывают параметры и ожидаемый результат
3. Протоколы. Язык взаимодействия между службами одного уровня


Набор уровней и используемые протоколы -- архитектура сети.

Набор протоколов, используемых на каждом уровне -- стек протоколов.


- Физическая среда передачи
- Ур 1 -- Ур 1
- Ур 2 -- Прот. ур. 2 -- Ур 2
- Ур 3 -- Ур 3
- Ур 4 -- Ур 4
- Ур 5


## Эталонная модель OSI

- Application -- прикладной уровень -- нужен только для того, чтобы программистам было удобнее писать программы (например, текстовые протоколы)
- Presentation -- уровень представления -- данные рассматриваются по типам (аудио, видео, текст и т.д.). Сейчас также реализован на прикладном уровне
- Session -- нужен для создания виртуальных каналов/сеансов связи. Например, при видеоконференции голос может обслуживаться по высокому качеству, а видео по остаточному принципу. В реальной жизни создаются обычно на уровне ниже или выше
- Transport -- транспортный -- этот уровень должен проверять, дошли ли данные и проверять их порядок
- Network -- множество узлов, между которыми данные передаются через всю сеть
- Data link -- канальный уровень -- уровень передачи данных, единицы и ноли именно здесь
- Physical -- сигнал, напряжение, амплитуда, частота, световые лучи


## TCP/IP

- application, presentation, session -- прикладной
- transport -- уровень передачи (TCP -- Transmission Control Protocol, UDP -- User Diagram Protocol)
- network -- IP -- уровень межсетевого взаимодействия
- data link, physical -- уровень доступа к среде (например, ethernet)


## Гибридная модель

- application, presentation, session -- прикладной
- transport -- транспортный -- сегмент
- network -- сетевой -- дектаграмма
- data link -- канальный -- кадр (пакет канального уровня)
- physical -- физический


## Классификация компьютерных сетей

### По технологии передачи

1. Вещание
2. Точка - точка

### По принципу организации обмена

1. Коммутация каналов (например, старая телефонная станция)
2. Коммутация сообщений
3. Коммутация пакетов (пакет меньше сообщения, поэтому пакеты от разных наборов данных могут посылаться вперемешку

### По территориальной распространенности

1. LAN -- Local Area Network (несколько соединенных помещений), ЛВС -- локальная вычислительная сеть
2. CAN -- Campus Area Network (одно или несколько связанных зданий)
3. MAN -- Metropolitain Area Network (сеть масштаба города)
4. WAN -- Wide Area Network (сеть масштабов страны), ГВС -- глобальная вычислительная сеть
5. SAN -- Solar Area Network
6. GAN -- Galactic Area Network

### По топологии

1. Кольцо
2. Шина
3. Звезда

### По скорости

Плавает

### По типу среды передачи данных

1. Проводные
2. Беспроводные

### По иерархии

1. Одноранговые
  - p2p
    - Napster
    - eDonkey
    - BitTorrent
    - Kad
    - i2p
    - TOR
2. С выделенным сервером


### Физический уровень

Среда передачи данных -- линии или каналы связи, по которым компьютеры могут обмениваться информацией.

- Кабельные
- Проводные
- Беспроводные

Параметры кабеля:

1. Полоса пропускания -- частотный диапазон
2. Задержка распространения сигнала
3. Затухание -- потеря мощности на выходе по сравнению со входом
4. Волновое сопротивление


Виды кабелей:

1. Коаксиальный кабель (RG-8, RG-11)
  - Структура
    - Центральная медная жила (по которой передаются данные)
    - Защитный полупроводник
    - Защитная оплетка
    - Внешняя оболочка
  - 50 Ом
  - 0.89 мм / 5 мм
2. Витая пара
  - STP (Shielded Twitsted Pair)
  - UTP (Unshielded Twitsted Pair)
  - Коннектор -- RJ-45 (точнее, похож на него)
  - Коннектор у телефонной витой пары -- RJ-11
  - Официально один сегмент может быть длиной до 100 метров
  - Категории
    1. Использовался до 1993 года в основном для телефонных линий
    2. Полоса пропускания 1 МГц. Использовалась исключительно в IBM
    3. Использовалась в телефонии после первой категории (16 МГц). По ней и начали передавать данные
    4. Большой популярности не получил, полоса пропускания 20 МГц
    5. Либо 5e. Полоса пропускания 100 МГц. Используется сейчас
    6. Полоса пропускания 200 МГц
      - UTP
      - STP
    7. Полоса пропускания 600 МГц. Как и 6я категория, особую популярность не получили
      - Только STP
3. Оптоволокно
  - Структура
    - В центре стеклянная жила
    - Заключена в другую жилу с другим коэффициентом преломления
  - Оптоволокно очень хрупкое, для соединения провода сваривают
  - Бывают одномодовые и многомодовые (луч одной частоты, либо лучи разных частот с разными углами отражения)
    - Одномодовый -- 9/125 мкм (центральная жила и диаметр стеклянной оболочки) -- до ~10 км
    - Многомодовый -- 50/125 мкм, 62.5/125 мкм -- до ~2 км


## Виды сигналов и их передача

Бод -- символы в секунду.


# Канальный уровень

Поддерживает уровень между двумя хостами, т.е. связь хост-хост/узел-узел.

Существует 2 типа канала:
- Широковещательный. Множество устройств с одной линией связи. Протоколы доступа
  к несущей - протоколы, разреш. проблемы связи.
- Точка-точка. 1 получает, другой адресует. Протокол доступа к несущей здесь
  прост.

# Службы канального уровня.

Как правило, каждый кадр канальногоь уровня содержит одну дейта

![alt text](seti_3.jpg)

Основная служба - перемежение дейтаграм между двумя узлами по одной линии связи.

Сервисы канального уровня:
1. Формирование кадра.
2. Доступ к линии связи (MAC).
3. Надежная доставка. (Передоставка, дублирование линий связи).
4. Управление потоком
5. Обнаружение ошибок
6. Исправление ошибок
7. Дуплексная и полудуплексная передача.

# Сетевые адапторы. NIC (network interface card)

![alt text](seti_4.jpg)

# Обнаружение и исправление ошибок.
Если целый, то передаем на следующий уровень. Если нет, то, как правило,
отбрасываем.  

![alt text](seti_5.jpg)

Чтобы решить какую-то проблему используют контроль по нечетности.

d1,1...d1,j     | d1,j+1

d2,1...d2,j     | d2,j+1

-------------------

di,1...di,j     | di,j+1

--------------------

di+1,1...di+1,j | di+1,j+1


CRC (Cyclic Redundancy Check)

D (Nразр) R (r разр)

P(x) = sum (n = 0 to N - 1) an x^n

G(Gx) - порождаемый многочлен

R(x) = P(x) * 2k mod G(x)


# Протоколы коллективного доступа

## TDM и FDM-мультиплексироание

- TDM (Time Division Multiplexing)
  - Справедливое разделение канала
  - На время слота клиенту предоставляется вся пропускная способность канала
- FDM (Frequent Division Multiplexing)
  - Справедливое разделение канала

R бит/c

N устройств


## CDMA

Code Division Multiple Access (множественный доступ с кодовым разделением канала).

d0 = 1, d1 = -1

c = (1, 1, 1, -1, 1, -1, -1, -1)

Умножаем c на каждый из этих битов.

z0 = (1, 1, 1, -1, 1, -1, -1, -1)

z1 = (-1, -1, -1, 1, -1, 1, 1, 1)

z0 и z1 передаются по каналу связи.

На приемной стороне также присутствует код C, соответствующий отправителю.

di = 1/M sum(m = 1 to M) Z i, m * Cm

Протокол CDMA работет в предположении об аддитивности интерферирующих битовых сигналов (пересекающиеся складываются).


- Отправитель 1
  - d01 = 1 d11 = -1
  - c1 = (1, 1, 1, -1, 1, -1, -1, -1)
  - z01 = (1, 1, 1, -1, 1, -1, -1, -1)
  - z11 = (-1, -1, -1, 1, -1, 1, 1, 1)
- Отправитель 2
  - d02 = 1, d12 = 1
  - c2 = (1, -1, 1, 1, 1, -1, 1, 1)
  - z02 = (1, -1, 1, 1, 1, -1, 1, 1)
  - z12 = (1, -1, 1, 1, 1, -1, 1, 1)
- (+)
  - z0 = (2, 0, 2, 0, 2, -2, 0, 0)
  - z1 = (0, -2, 0, 2, 0, 0, 2, 2)
- Получатель
  - C1 = (1, 1, 1, -1, 1, -1, -1, -1)
  - C2 = (1, -1, 1, 1, 1, -1, 1, 1)
  - di = 1/M sum (m = 1 to M) z ^ * i, m  *  cm


# Протоколы произвольного доступа

## ALOHA

- Все кадры одинаковые
- Все время разделено на слоты, равные времени передачи одного кадра
- Узлы начинают передачу кадров только в момент начала очередного слота
- Узлы синхронизируются так, что каждый узел знает, когда начинается слот
- Если в течение слота происходит коллизия, то узлы ее обнаруживают до окончания этого слота


## Протоколы CSMA и CSMA/CD



    Одна пропущенная лекция.




- WS
    + Физический
    + Канальный
    + Сетевой
    + Транспортный
    + Прикладной
- R
    + Физический
    + Канальный
    + Сетевой
- R
    + Физический
    + Канальный
    + Сетевой
- R
    + Физический
    + Канальный
    + Сетевой
- WS
    + Физический
    + Канальный
    + Сетевой
    + Транспортный
    + Прикладной

Сетевой уровень сквозной.


## Модели сетевого обслуживания

Модель сетевого обслуживания определяет характеристики сквозного транспорта данных между двумя периферийными устройствами сети.

- Виртуальный канал (VC)
    - В установку соединения вовлечены все промежуточные пакетные коммутаторы
    - (1) - инициировать соединение
    - (2) - входящее соединение
    - (3) - принять соединение
    - (4) - соединение установлено
    - (5) - начинается передача потока данных
    - (6) - получение данных
- Дейтаграммы
    + Пакетные коммутаторы в данном случае называются маршруторизаторами


## Функции сетевого уровня

1. Определение пути
2. Продвижение данных
3. Установка соединений


## Основы маршруторизации

Классификация:

- По наличию информации о сети
    - Глобальный
        + LS - Line State (алгоритм Дейкстры) - есть информация о всей структуре сети
    - Децентрализованный
        + DV - Distance Vector - есть информация об небольшом участке сети
- По области применения
- По частоте изменения маршрутов
    + Статические
    + Динамические
- По чувствительности к перегрузкам
    + Чувствительные
    + Нечувствительные


## Интернет-протоколы

- IP - сетевой уровень, который определяет адресацию сетевого уровня, формат полей дейтаграммы и действия над дейтаграммами, принимаемые маршруторизаторами и конечными системами
- Компоненты определения пути (протоколы маршруторизации) - позволяют выбрать маршрут, по которому будет следовать дейтаграмма от отправителя до получателя
- ICMP - сигнальный протокол


### IPv4

#### Формат дейтаграммы

- (1)
    + Версия - 4 бита
    + Длина заголовка (от 20 байт)
    + Тип службы (TOS), 6 бит - DSCP (Differentiated Services Code Point) - разделение на типы, 2 бита - ECN (Explicit Congestion Notification) - предупреждение о перегрузке сети без потери пакетов
    + Длина дейтаграммы, байт - полная длина ip-дейтаграммы (заголовок + данные) - 16 бит, т.е. максимальный размер - 65536 байт, в ethernet ограничен 1500
- (2)
    + 16-разрядный идентификатор
    + Флаги
    + 13-разрядное смещение фрагмента - эти поля нужны для фрагментации, первый будет с нулевым смещением и т.д.
- (3)
    + Время жизни - TTL (Time to Live), 8 бит, максимальное - 4 минуты 16 секунд, однако сейчас это используется для подсчета количества хопов, сейчас по умолчанию ставят 64
    + Протокол верхнего уровня - 8 разрядов, TCP/UDP
    + Контрольная сумма заголовка - позволяет обнаруживать ошибки в заголовках дейтаграмм
- (4) - 32-разрядный IP-адрес отправителя
- (5) - 32-разрядный IP-адрес получателя
- (6) - Параметры (если есть)
- (7) - Данные


### Фрагментация IP-дейтаграмм

...


4000 Б      ID 777     MTU 1500

- Фрагмент: 1, Байты: 1480, ID: 777, Смещение 0:, Флаг: 1
- Фрагмент: 2, Байты: 1480, ID: 777, Смещение 1480:, Флаг: 1
- Фрагмент: 3, Байты: 1020, ID: 777, Смещение 2860:, Флаг: 0


# Адресация

IP: `11000001 00100000 11011000 00001001`  
SM: `11111111 11111111 11111111 00000000`

IP: `193.32.216.9/24`
SM: `255.255.255.0`


Пять классов адресов.


- Ключ              - 0 - Класс "А" (1 бит), 7 бит (сеть)
- Адрес сети        - Хост
- Адрес хоста       - Хост


1.0.0.0 - 127.255.255.255

10 - класс B (128.0.0.0 - 191.255.255.255), 110 - класс C. (192.0.0.0 - 223.255.255.255), 1110 - класс D (224.0.0.0 - 239.255.255.255), 1111 - класс E (240.0.0.0 - 255.255.255.255).

CIDR (Classless Inter Domain Routing).


`10.0.0.0/8`

`172.16.0.0/12`

`192.168.0.0/16`

`127.0.0.0/8` - loopback

`169.254.0.0/16`


# Получение сетевого адреса

1. Ручное
2. Автоматическое
  - DHCP (Dynamic Host Configuration Protocol)
  - APIPA (Automatic Private IP Adressing)

ICMP - Internet Control Message Protocol.




----------------------------

DHCP

----------------------------



# NAT (Network Address Translation)

...



ДЗ: Алгоритм Дейкстры. Line state. Дистанционный вектор.



Системы ввода вывода:

1. Общая память
2. Общая шина
3. Использование матричного коммутатора



# IPv6

Усовершенствования:

1. Более лучше соответствует высоким скоростям современной сети
2. Более лучше соответствует смешанным потокам данных (мультимедиа)
3. Поддержка большого числа адресов
4. Обеспечение безопасности

Заголовки расширения:

1. Обязательный, он всегда первый
2. Заголовок параметров ретрансляционных участков - определяет специальные параметры, требующие обработки на уровне ретрансляционных участков
3. Заголовок параметров получателя, которые будут обработаны первым получателем, указанным в адресе получателя IPv6, а также последующими получателями, перечисленными в заголовке маршрутизации - заголовок параметров получателя это фактически все получатели
4. Заголовок маршрутизации - обеспечивает расширенную маршрутизацию
5. Заголовок фрагмента - содержит информацию о фрагментации и повторной сборке
6. Заголовок аутентификации - обеспечивает целостность и аутентификацию пакета
7. Заголовок инкапсуляции защищенных данных - обеспечивает секретность
8. Заголовок параметров получателя для параметров, которые может обработать только конечный получатель

Заголовок IPv6:

1. Версия - шшшш
2. Класс трафика (8 бит) - может использоваться отправителями и/или продвигающими маршрутизаторами для идентификации и разделения разных классов и приоритетов пакетов - дифференцированный QoS. Рекомендации по использованию:
  - Это поле могут устанавливать протоколы более высокого уровня
  - Узлам, поддерживающим это поле, разрешается изменять значение
  - Соответственно, протокол вышестоящего уровня не должен предполагать, что поле осталось неизменным
3. Метка потока (20 бит) - может быть использована хостом для пометки пакетов, для которых запрашивается специальная обработка маршрутизаторами сети для пометки пакетов
  - Хосты или маршрутизаторы, которые не поддерживают метку потока, должны устанавливать ее в нуль при отправке пакета и не изменять при ретрансляции
  - У всех пакетов одного потока помимо адресов и метки должны совпадать также заголовки параметров ретрансляционных участков и заголовок маршрутизации
  - Новые метки должны выбираться случайным образом, равномерно, в диапазоне от 1 до 2**20 - 1
4. Полезная длина
5. Следующий заголовок (8 бит)
6. Предел количества ретрансляционных участков (8 бит)
7. Адрес источника (128 бит)
8. Адрес приемника/получателя (128 бит)

3 типа адресов IPv6:

1. Целевая рассылка (unicast)
  - Есть целевой интерфейс, который имеет адрес и пакет доставляется этому интерфейсу
2. Выборочная рассылка (anycast)
  - Есть группы интерфейсов, которые имеют один и тот же адрес (причем эти интерфейсы принадлежат разным узлам
  - Пакет, отправленый по такому адресу, доставляется одному из интерфейсов, с которым связан этот адрес (как правило выбирается тот, который находится с точки зрения маршрутизатора ближе
3. Групповая рассылка (multicast)
  - Доставляется всем интерфейсам, с которым этот адрес связан

Заголовок параметров ретрансляционных участков:

1. Следующий заголовок (8 бит)
2. Длина заголовка расширения (8 бит)
3. Поле параметров
  - А: тип параметра (8 бит)
  - Б: длина поля данных параметра в байтах (8 бит)
  - В: данные параметров (переменная длина)

- 2 бита: способ обработки
- 1 бит: может ли поле параметров меняться


# Web и HTTP

:)

- 1.0 - отсутствие конвеерной обработки и постоянных соединений
- 1.1 - обратная совместимость с 1.0, виртуальные хосты

Протокол текстовый.

Пример:

```
GET /users HTTP/1.1
Host: resure.net
Connection: close
User-Agent: Mozilla/4.0
Accept-Language: ru
```

- GET
- POST
- HEAD
- PUT
- DELETE


## FTP

File Transfer Protocol.


## Электронная почта


